# Foundry 基础入门

## 开发环境搭建

### Rust 工具链安装
```bash
# 安装 Rust 工具链
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
source "$HOME/.cargo/env"

# 验证安装
rustc --version
```

### Foundry 全家桶安装
```bash
# 安装 foundryup
curl -L https://foundry.paradigm.xyz | bash

# 安装最新工具链
foundryup
```

## 项目初始化

### 创建项目结构
```bash
forge init my_project
cd my_project
```

项目目录结构：
```
.
├── foundry.toml    # 配置文件
├── lib/            # 依赖库
├── script/         # 部署脚本
├── src/            # 合约源码
└── test/           # 测试用例
```

### 配置文件解析（foundry.toml）
```toml
[profile.default]
src = 'src'
out = 'out'
libs = ['lib']
solc_version = "0.8.20"
optimizer = true
optimizer_runs = 200
```

## 基础命令实践

### 合约编译
```bash
forge build
```
✅ 编译成功后生成 `out` 目录，包含合约 ABI 和字节码

### 测试用例实践
创建测试文件 `test/Counter.t.sol`：
```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "forge-std/Test.sol";

contract CounterTest is Test {
    function test_Increment() public {
        uint256 i = 0;
        i += 1;
        assertEq(i, 1);
    }
}
```

运行测试：
```bash
forge test -vvv
```

### 合约交互
部署示例合约后使用 cast 调用：
```bash
# 查询 ERC20 余额（示例）
cast call 0x6B175474E89094C44Da98b954EedeAC495271d0F \
  "balanceOf(address)(uint256)" 0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045 \
  --rpc-url https://eth-mainnet.g.alchemy.com/v2/YOUR_KEY
```

## 学习检查清单
1. 能成功编译包含多个依赖的合约项目
2. 能编写包含断言和日志的测试用例
3. 能通过 cast 与已部署合约进行基础交互
4. 能配置多网络环境的 foundry.toml

## 常见问题解决
1. 安装失败时尝试：`export FOUNDRY_DIR=/usr/local/bin`
2. 测试报错时检查 solidity 版本一致性
3. 网络请求失败时配置国内镜像源


建议按照以下顺序实践：
1. 环境安装 → 2. 初始化项目 → 3. 运行示例测试 → 4. 自定义测试用例 → 5. 合约编译部署